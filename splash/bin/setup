#!/usr/bin/env bash

pushd `pwd` # store current dir
cd `dirname "$0"` # cd to script path
cd .. # cd to splash root

echo "--- decrypting secrets..."
./bin/blackbox/decrypt_all_files
source .env

echo "--- building signalboost_splash docker image..."
docker build -f docker/signalboost_splash.dockerfile -t "signalboost_splash:latest" .
echo "--- done building signalboost_splash docker image"

echo "--- installing dependencies..."
docker-compose -f docker-compose-dev.yml \
               run --entrypoint 'yarn install' \
               splash
docker-compose -f docker-compose-dev.yml down
echo "--- DONE!"

popd
