#!/usr/bin/env bash

if [ -z $CHANNEL_PHONE_NUMBER ];then
  echo "--- ERROR: no CHANNEL_PHONE_NUMBER found. try \`\$ source .env\`"
  exit 1
fi

echo "> Running signal-cli in daemon mode for channel $CHANNEL_PHONE_NUMBER"

signal-cli -u ${CHANNEL_PHONE_NUMBER} daemon --system | sed -rn "s/(Timestamp.*)(\()(.*)(\))/[\3] message sent to\/from $CHANNEL_PHONE_NUMBER/p" --unbuffered
